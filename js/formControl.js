document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector("button.js-only");e&&(e.style.display="inline-flex",e.disabled=!1);const t=document.getElementById("contactForm"),a=document.getElementById("formMessage"),o={name:t.elements.name,apellidos:t.elements.apellidos,email:t.elements.email,subject:t.elements.subject,message:t.elements.message,_gotcha:t.elements._gotcha};function s(e){return e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}function n(e){return/^\d+$/.test(e)}function r(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function l(e){e.classList.remove("error");const t=e.parentElement.querySelector(".error-message");t&&(t.textContent="",t.style.display="none")}function c(e,s="error"){a.textContent=e,a.className="form-message "+s,a.style.display="block","success"===s&&setTimeout((()=>{a.style.display="none",t.reset(),Object.values(o).forEach(l);t.querySelector('button[type="submit"]').disabled=!1}),4e3)}function i(e){const t=e.name,a=e.value.trim();let o=!1,r="";switch(t){case"name":a?n(a)?r="El nombre no puede contener solo números.":a.length<2?r="El nombre debe tener al menos 2 caracteres.":o=!0:r="El nombre es obligatorio.";break;case"apellidos":a?n(a)?r="Los apellidos no pueden contener solo números.":a.length<2?r="Los apellidos deben tener al menos 2 caracteres.":o=!0:r="Los apellidos son obligatorios.";break;case"email":a?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?o=!0:r="El email debe ser válido.":r="El email es obligatorio.";break;case"subject":a?a.length<4?r="El asunto debe tener al menos 4 caracteres.":o=!0:r="El asunto es obligatorio.";break;case"message":a?a.length<10?r="El mensaje debe tener al menos 10 caracteres.":o=!0:r="El mensaje es obligatorio.";break;case"_gotcha":o=!a}return o?(l(e),"name"!==t&&"apellidos"!==t||!a||(e.value=s(e.value))):function(e,t){e.classList.add("error");const a=e.parentElement.querySelector(".error-message");a&&(a.textContent=t,a.style.display="block",a.setAttribute("aria-live","polite"))}(e,r),o}["name","apellidos"].forEach((e=>{const t=o[e];t.addEventListener("input",(()=>{const e=t.selectionStart;t.value=s(t.value),t.setSelectionRange(e,e),i(t)}))})),["email","subject","message"].forEach((e=>{const t=o[e];t.addEventListener("blur",(()=>{i(t)}))})),t.addEventListener("submit",(async function(e){if(e.preventDefault(),!i(o._gotcha))return;let a=!0;if(Object.values(o).forEach((e=>{"_gotcha"===e.name||i(e)||(a=!1)})),!a)return void c("Por favor, corrige los campos marcados en rojo.","error");const s=t.querySelector('button[type="submit"]');s.disabled=!0;const n={name:r(o.name.value.trim()),apellidos:r(o.apellidos.value.trim()),email:r(o.email.value.trim()),subject:r(o.subject.value.trim()),message:r(o.message.value.trim())},l=new FormData;for(let e in n)l.append(e,n[e]);l.append("_gotcha","");try{const e=await fetch("https://formspree.io/f/xgvlwnkb",{method:"POST",body:l,headers:{Accept:"application/json"}});if(e.ok)c("Mensaje enviado correctamente. ¡Gracias!","success");else{const t=await e.json();c(t.error||"Hubo un problema al enviar el formulario.","error"),s.disabled=!1}}catch(e){c("Error de red. Intenta más tarde.","error"),s.disabled=!1}}))}));